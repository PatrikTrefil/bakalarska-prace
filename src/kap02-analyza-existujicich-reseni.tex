\chapter{Analýza existujících řešení}\label{ch:analyza-existujicich-reseni-pro-praci-s-formulari}

V době analýzy existujících řešení (od sprna 2022 do září 2022) jsem nenalezl žádné řešení pro online spolupráci terapeutů a pacientů/klientů.
Pro vyhledávání jsem použil primárně vyhledávač Google.
Také jsem používal vyhledávání na platformách \href{https://github.com/}{GitHub} a \href{https://about.gitlab.com/}{GitLab}.
Pro vyhledání jsem použil klíčová slova jako \textit{therapy}, \textit{collaboration}, \textit{software}, \textit{mental health} apod.

Velkou část aplikace, kterou chceme vyrobit, tvoří systém pro správu formulářů.
V této kapitole se tedy zaměříme na analýzu existujících řešení pro tvorbu formulářů a sběr dat.
V kapitole popíšeme nalezené nástroje a jejich výhody a nevýhody.
Pokud se ukáže, že je některý z nástrojů vhodný pro naše použití, tak jej začleníme do naší aplikace.


\section{Problematika správy formulářů}\label{sec:problematika-spravy-formularu}

Hledaná řešení lze rozdělit ná několik částí.
První část je rozhraní pro tvorbu formulářů.
V našem případě by to mělo být drag and drop rozhraní, které umožní vytvářet formuláře bez nutnosti znalosti programování.
Druhá část je formát pro ukládání vytvořených formulářů.
Při uložení je potřeba ukládat nejenom strukturu formuláře, ale také styly jednotlivých prvků a logiku formuláře.
Logika obsahuje například podmíněné zobrazení otázek, přechody mezi stránkami formuláře v případě, že se jedná o vícestrankový formulář, či validaci vstupu.
Třetí část je vykreslení uložených formulářů.
Tato část na základě uložené definice formuláře vykreslí formulář, který je následně možné vyplnit.
Čtvrtá část je sběr dat z formulářů.
Sběr dat zahrnuje ukládání jednotlivých odpovědí, metadata o vyplnění formuláře a také zpřístupnění sesbíraných dat terapeutům.
Pátá část je možnost uživatele uložit částečně vyplněný formulář a dokončit vyplnění později.
Dokončení může proběnout i na jiném zařízení.
Tato schopnost systému byla uvedena jako požadavek~\ref{itm:r-fr-5}.
Budeme primárně hledat řešení, které řeší všechny tyto části.
Pokud se však ukáže, že existuje sada nástrojů, které lze kombinovat a dohromady řeší všechny tyto části, tak je také zvážíme.

Nástroje mohou mít formu služby nebo knihovny.
Mezi hlavní požadavky na nástroj pro správu formuláře patří možnost podmíněného zobrazení otázek, kvalitní dokumentace a možnost hostovat na vlastní infrastruktuře.
Důležité kritérium pro výběr je samozřejmě i cena.
Pro hledání nástrojů byly použit vyhledávač Google, vyhledávání na platformách \href{https://github.com/}{GitHub} a \href{https://about.gitlab.com/}{GitLab}.
Pro vyhledávání byly použity klíčová slova jako \textit{form builder}, \textit{form management}, \textit{form rendering}, \textit{form serialization} apod.
Srovnání nástrojů je shrnuto na konci kapitoly v tabulce~\ref{tab:srovnani-existujicich-reseni}.

\section*{Google Formuláře}\label{sec:google-formulare}

\href{https://www.google.com/forms/about/}{Google Formuláře} je jeden z nejrozšířenějších nástrojů pro tvorbu formulářů.
Formuláře v tomto nástroji lze snadno vytvářet v prohlížeči a následně sdílet pomocí odkazu s plniteli.
Jeden formulář může spravovat více uživatelů.
Výsledky formulářů lze analyzovat pomocí nástroje \href{https://www.google.com/intl/cs/sheets/about/}{Google Tabulky} či exportovat do souboru.
Google Formuláře podporují uložení částečně vyplněných formulářů a dokončení vyplnění později na jiném zařízení, ale pouze pro uživatele, kteří jsou přihlášení do svého Google účtu~\cite{save-and-return-google-forms}.
Není možné požadovat po uživatelích, aby se přihlásili do svého Google účtu, jelikož sbíraná data musí být asociovaná pouze s náhodně vygenerovanými identifikátory.
Pro naše účely tedy Google Formuláře požadavek na uložení částečně vyplněných formulářů nepodporuje.
Nevýhodou Google Formulářů je, že neumožňují přizpůsobení vzhledu formulářů.
Další nevýhodou je, že Google Formuláře sbírají data o uživatelích, kteří formulář vyplňují.
Google Formuláře nenabízejí variantu s hostováním na vlastní infrastruktuře.
Cena za tento produkt ke dni 20.~3.~2023 je \$12 na uživatele měsíčně.

\section*{Form.io}\label{sec:formio}

\href{https://form.io/}{Form.io} poskytuje veškeré funkce, které jsou vyžadovány zadavatelem.
Form.io umožňuje velkou míru upravení vzhledu a fungování formulářů.
Form.io je používáno mnoha velkými společnostmi jako je \href{https://www.visa.cz/}{Visa} či \href{https://www.icann.org/}{ICANN}\@.
Tento software je v zahraničí využíván i ve státních institucích.
Konkrétně se používá pro provoz pohraničních sil Britské vlády~\cite{formio-use-camundacon}.
Form.io umožňuje uložit částečně vyplněný formulář a dokončit vyplnění později i na jiném zařízení~\cite{save-and-return-formio}.
Software lze hostovat na vlastní infrastruktuře.
Dle \href{https://form.io/pricing}{ceníku} ke dni 20.~3.~2023 varianta s hostováním na vlastní infrastruktuře však stojí \$900 měsíčně.

\section*{OpnForm}\label{sec:opnform}

\href{https://opnform.com/}{OpnForm} je open-source řešení, které je aktivně vyvíjeno.
Je to poměrně mladý projekt, který byl založen v září roku 2022.
Projekt nemá ke dni 13.~3.~2023 žádnou dokumentaci ani ceník.
Tedy nelze posoudit, zda-li splňuje všechny požadavky zadavatele.

\section*{Typeform}\label{sec:typeform}

\href{https://www.typeform.com/}{Typeform} je úspěšný nástroj pro tvorbu online formulářů.
Nástroj je velmi vyspělý a poskytuje mnoho funkcí včetně větvení formulářů na základě předchozích odpovědí.
Typeform také nenabízí variantu s hostováním na vlastní infrastruktuře.
Typeform neumožňuje sledování chování uživatele~\cite{user-tracking-typeform}.
Typeform sbírá data o uživatelích, kteří formulář vyplňují~\cite{user-data-typeform}.
Typeform umožňuje uložit částečně vyplněný formulář a dokončit vyplnění později, ale pouze v rámci jednoho zařízení~\cite{save-and-return-typeform}.
V případě potřeby více než 5 uživatelských účtů záleží cena na dohodě.

\section*{Knihovny pro práci s formuláři}\label{sec:knihovny-pro-praci-s-formulari}

Pro práci s formuláři existuje mnoho knihoven.
První problém je interoperabilita mezi knihovnami.
Způsob ukládání definic formulářů je totiž různý mezi knihovnami.
Najít jednu knihovnu pro tvorbu formulářů a jinou nezávislou knihovnu pro vykreslování formulářů se tedy nepovedlo.
Proto se podíváme na knihovny, které řeší oba problémy.

Největší nadějí byla knihovna \href{https://uniforms.tools/}{uniforms}.
Tato knihovna řeší vykreslování formulářů a podporuje několik různých formátů definice formulářů.
Knihovna navíc není závislá na konkrétním UI frameworku, což je velká výhoda.
Tato knihovna je vyvíjena firmou \href{https://www.vazco.eu/}{Vazco}.
Část knihovny, která je určena pro vykreslování formulářů je však součástí placeného produktu.
Firmu jsem kontaktoval a dostal jsem potvrzení, že můžeme jejich knihovnu pro tento projekt bezplatně použít.
Hned po obdržení potvrzení však firma přestala reagovat na mé e\babelhyphen{nobreak}maily.
Navzdory několika dalším pokusům o kontaktování firmy dopadlo toto jednání neúspěšně.

Další alternativou je knihovna \href{https://formilyjs.org/}{Formily}.
Formily je open-source projekt, který má přes 10 tisíc hvězdiček \href{https://github.com/alibaba/formily}{v repozitáři na platformě Github}.
Za projektem navíc stojí velká komerční firma \href{https://www.alibaba.com/}{Alibaba}.
Projekt je aktivně vyvíjen, ale bohužel v době volby technologie nebyla dostupná dokumentace v anglickém jazyce.
Z důvodu chybějící dokumentace bylo nutné zvolit jinou knihovnu.

\section*{Závěr}\label{sec:zaver-analyzy-existujicich-reseni}

Nepodařilo se najít žádnou vhodnou kombinaci knihoven, která by alespoň částečně řešila náš problém.
Vlastnosti nalezených služeb jsou shrnuty v tabulce~\ref{tab:srovnani-existujicich-reseni}.
Jak je vidět z tabulky, tak jediným nástrojem, který splňuje všechny požadavky zadavatele je Form.io.
Jak konkrétně nástroj použijeme v naší aplikaci bude popsáno v sekci~\ref{subsec:software-pro-praci-s-formulari}.

\newcommand{\yes}{\tikzcmark\ Ano}
\newcommand{\no}{\tikzxmark\ Ne}
\renewcommand\tabularxcolumn[1]{m{#1}} % vertical centering in X column https://latex.org/forum/viewtopic.php?t=32433
%\begin{table}[h!]
%    \centering
%    \begin{tabularx}{\textwidth}{
%        | >{\centering\arraybackslash}X
%        | >{\centering\arraybackslash}X
%        | >{\centering\arraybackslash}X
%        | >{\centering\arraybackslash}X
%        | >{\centering\arraybackslash}X
%        | >{\centering\arraybackslash}X |
%    }
%        \hline
%        & \textbf{Podmíněné zobrazení} & \textbf{Kvalitní dokumentace} & \textbf{Self-hosting} & \textbf{Nesbírá data o uživatelích} & \textbf{Cena} \\
%        \hline
%        \textbf{Form.io} & \yes & \yes & \yes & \yes & \$900 \\
%        \hline
%        \textbf{Google formuláře} & \yes & \yes & \no & \no & \$12 na uživatele \\
%        \hline
%        \textbf{OpnForm} & \yes & \no & \no & Neznámé & \$0 \\
%        \hline
%        \textbf{TypeForm} & \yes & \yes & \no & \no & Neznámé \\
%        \hline
%    \end{tabularx}
%    \caption{Srovnání existujících řešení}
%\end{table}

\begin{table}[h!]
    \centering
    \begin{tabularx}{\textwidth}{
        | >{\centering\arraybackslash}X
        | >{\centering\arraybackslash}X
        | >{\centering\arraybackslash}X
        | >{\centering\arraybackslash}X
        | >{\centering\arraybackslash}X
        | >{\centering\arraybackslash}X |
    }
        \hline
        & \textbf{Form.io} & \textbf{Google Formuláře} & \textbf{OpnForm} & \textbf{TypeForm} \\
        \hline
        \textbf{Podmíněné zobrazení}            & \yes             & \yes                      & \yes             & \yes              \\
        \hline
        \textbf{Kvalitní dokumentace}           & \yes             & \yes                      & \no              & \yes              \\
        \hline
        \textbf{Self-hosting}                   & \yes             & \no                       & \yes             & \no               \\
        \hline
        \textbf{Nesbírá data o uživatelích}     & \yes             & \no                       & Neznámé          & \no               \\
        \hline
        \textbf{Uložení nedokončeného vyplnění} & \yes             & \no                       & Neznámé          & \no               \\
        \hline
        \textbf{Cena}                           & \$900            & \$12 na uživatele         & \$0              & Neznámé           \\
        \hline
    \end{tabularx}
    \caption{Srovnání existujících řešení}
    \label{tab:srovnani-existujicich-reseni}
\end{table}
